re_set_religion_mechanic_nestorian_patriarchy_value = {
	if = {
		limit = {
			re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
		}
		[[value]
			set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = $value$ }
		]
		[[which]
			set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value which = $which$ }
		]
		hidden_effect = {
			if = {
				limit = {
					re_has_religion_mechanic_nestorian_patriarchy_value = { value = 200 }
				}
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = 200 }
			}
			else_if = {
				limit = {
					NOT = { re_has_religion_mechanic_nestorian_patriarchy_value = { value = 0 } }
				}
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = 0 }
			}
		}
	}
}

re_add_religion_mechanic_nestorian_patriarchy_value = {
	if = {
		limit = {
			re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
		}
		[[value]
			change_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = $value$ }
		]
		[[which]
			change_variable = { which = re_religion_mechanic_nestorian_patriarchy_value which = $which$ }
		]
		hidden_effect = {
			if = {
				limit = {
					re_has_religion_mechanic_nestorian_patriarchy_value = { value = 200 }
				}
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = 200 }
			}
			else_if = {
				limit = {
					NOT = { re_has_religion_mechanic_nestorian_patriarchy_value = { value = 0 } }
				}
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = 0 }
			}
		}
	}
}

re_export_yearly_religion_mechanic_nestorian_patriarchy_value_gain = {
	hidden_effect = {
		export_to_variable = {
			which = re_yearly_religion_mechanic_nestorian_patriarchy_value
			value = modifier:re_yearly_religion_mechanic_nestorian_patriarchy_change
		}
		set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_modifiers which = re_yearly_religion_mechanic_nestorian_patriarchy_value }
		# Base:
		change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value value = 0.5 }
		# Missionaries:
		export_to_variable = {
			which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_missionaries
			value = trigger_value:num_of_missionaries
		}
		multiply_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_missionaries value = 0.5 }
		change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_missionaries }
		# Tolerance of True Faith:
		export_to_variable = {
			which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_ttf
			value = modifier:tolerance_own
		}
		change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_ttf value = -4 }
		multiply_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_ttf value = 0.5 }
		change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_ttf }
		# Stability:
		if = {
			limit = {
				stability = 1
			}
			set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability value = 1 }
			change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability }
		}
		else_if = {
			limit = {
				NOT = { stability = 0 }
			}
			set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability value = -1 }
			change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability }
		}
		else = {
			set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability value = 0 }
		}

		# Opinion of Constantinople Patriarchy
		if = {
			limit = {
				exists = NPA
				NOT = { tag = NPA }
				check_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value value = 0 }
			}
			export_to_variable = {
				which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion
				value = opinion
				who = NPA
				with = ROOT
			}
			divide_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 2 }
			divide_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 100 }
			change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 1 }
		}
		else = {
			set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 1 }
		}
		multiply_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion }
		change_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = -1 } # display
		multiply_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 100 } # display
	}
}

re_add_yearly_religion_mechanic_nestorian_patriarchy_value = {
	re_export_yearly_religion_mechanic_nestorian_patriarchy_value_gain = yes
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_temp which = re_yearly_religion_mechanic_nestorian_patriarchy_value }
	divide_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_temp value = 12 }
	re_add_religion_mechanic_nestorian_patriarchy_value = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_temp }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_temp value = 0 }
}

re_set_religion_mechanic_nestorian_patriarchy_patriarchy_controller = {
	if = {
		limit = {
			re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
		}
		custom_tooltip = re_set_religion_mechanic_nestorian_patriarchy_patriarchy_controller_tt
		hidden_effect = {
			every_country_including_inactive = {
				clr_country_flag = re_religion_mechanic_nestorian_patriarchy_is_patriarchy_controller
				remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_patriarch_controller_modifier
				clr_country_flag = re_religion_mechanic_nestorian_patriarchy_main_center_of_reformation_selection_window_open
				if = {
					limit = {
						NOT = { tag = PREV }
					}
					remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_interaction_3_modifier
					remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_interaction_6_modifier
				}
			}
			save_global_event_target_as = re_religion_mechanic_nestorian_patriarchy_patriarch_controller
			set_country_flag = re_religion_mechanic_nestorian_patriarchy_is_patriarchy_controller
			add_country_modifier = {
				name = re_religion_mechanic_nestorian_patriarchy_patriarch_controller_modifier
				duration = -1
			}
			country_event = { id = re_religion_mechanic_nestorian_patriarchy_events.1 }
			re_religion_mechanic_nestorian_patriarchy_clear_center_of_reformation = yes
			play_sound = "papal_controller"
			every_country = {
				limit = {
					ai = no
					re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					NOT = { re_religion_mechanic_nestorian_patriarchy_is_patriarchy_controller = yes }
				}
				play_sound = "new_pope_selected"
			}

			if = {
				limit = {
					has_ruler_modifier = re_religion_mechanic_nestorian_patriarchy_excommunicated_modifier
				}
				remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_excommunicated_modifier
			}
			clr_global_flag = re_religion_mechanic_nestorian_patriarchy_no_new_center_of_reformation
		}
	}
}

re_set_religion_mechanic_nestorian_patriarchy_center_of_reformation = {
	custom_tooltip = re_set_religion_mechanic_nestorian_patriarchy_center_of_reformation_tt
	hidden_effect = {
		re_religion_mechanic_nestorian_patriarchy_clear_center_of_reformation = yes
		save_global_event_target_as = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
		set_province_flag = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_setup
		add_province_triggered_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_province_triggered_modifier
		add_permanent_province_modifier = {
			name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_modifier
			duration = -1
		}
		if = {
			limit = {
				owner = {
					re_not_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
				}
			}
			province_event = { id = re_religion_mechanic_nestorian_patriarchy_events.9 }
		}
		if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 118
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 118 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 1816
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 1816 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 1099
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 1099 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 151
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 151 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 4293
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 4293 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 4447
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 4447 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 358
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 358 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 735
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 735 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					province_id = 85
				}
			}
			every_province = {
				limit = {
					re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = 85 }
					NOT = { religion = nestorian }
					owner = {
						re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
					}
				}
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
					duration = -1
				}
			}
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_clear_center_of_reformation = {
	hidden_effect = {
		every_province = {
			limit = {
				has_province_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
			}
			remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_region_modifier
		}
		if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
			}
			if = {
				limit = {
					has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation_target
				}
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation_target = {
					remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_target_modifier
				}
				clear_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation_target
			}
			event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
				remove_province_triggered_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_province_triggered_modifier
				remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_modifier
				clr_province_flag = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_setup
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_time value = 0 }
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 0 }
			}
			clear_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target = {
	hidden_effect = {
		if = {
			limit = {
				has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = { religion = nestorian }
					NOT = { has_construction = missionary }
					NOT = { has_province_modifier = religious_zeal_at_conv }
				}
			}
			event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
				save_event_target_as = nestorian_possible_target
			}
		}
		else = {
			if = {
				limit = {
					has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				}
				if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 118
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 118 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 1816
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 1816 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 1099
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 1099 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 151
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 151 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 4293
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 4293 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 4447
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 4447 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 358
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 358 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 735
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 735 }
				}
				else_if = {
					limit = {
						event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
							province_id = 85
						}
					}
					re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = { id = 85 }
				}
			}
		}
		if = {
			limit = {
				has_saved_event_target = nestorian_possible_target
			}
			event_target:nestorian_possible_target = {
				save_global_event_target_as = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation_target
				add_permanent_province_modifier = {
					name = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_target_modifier
					duration = -1
				}
			}
			event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
				set_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_time value = 0 }
				export_to_variable = {
					which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time
					value = trigger_value:development
					who = event_target:nestorian_possible_target
				}
				change_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = -6 }
				divide_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 2 }
				change_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 12 }
				round_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time }
				if = {
					limit = {
						check_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 36 }
					}
					set_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 36 }
				}
				else_if = {
					limit = {
						NOT = { check_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 12 } }
					}
					set_variable = { which = re_religion_mechanic_nestorian_patriarchy_center_of_reformation_conversion_end_time value = 12 }
				}
			}
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_pick_center_of_reformation_target_specific = {
	if = {
		limit = {
			has_saved_global_event_target = re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 200
						}
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 200
						}
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 200
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 200
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 150
						}
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 150
						}
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 150
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 150
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 100
						}
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 100
						}
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 100
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 100
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 50
						}
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 50
						}
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 50
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation = {
					NOT = {
						province_distance = {
							who = PREV
							distance = 50
						}
					}
				}
				OR = {
					any_neighbor_province = {
						religion = nestorian
					}
					area_for_scope_province = {
						religion = nestorian
					}
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				area_for_scope_province = {
					province_id = event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				area_for_scope_province = {
					province_id = event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				any_neighbor_province = {
					province_id = event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				}
			}
			save_event_target_as = nestorian_possible_target
		}
		random_province = {
			limit = {
				NOT = { religion = nestorian }
				NOT = { has_construction = missionary }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				re_religion_mechanic_nestorian_patriarchy_is_in_regions_for_center_of_reformation = { id = $id$ }
				any_neighbor_province = {
					province_id = event_target:re_religion_mechanic_nestorian_patriarchy_current_center_of_reformation
				}
				OR = {
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries_upgraded
					has_state_edict = re_religion_mechanic_nestorian_patriarchy_state_edict_silk_road_missionaries
				}
			}
			save_event_target_as = nestorian_possible_target
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
	if = {
		limit = {
			check_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_$category$_advisor_level value = 5 }
		}
		add_years_of_income = -1.5
		hire_advisor = {
			type = $type$
			skill = 5
		}
	}
	else_if = {
		limit = {
			check_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_$category$_advisor_level value = 4 }
		}
		add_years_of_income = -1.25
		hire_advisor = {
			type = $type$
			skill = 4
		}
	}
	else_if = {
		limit = {
			check_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_$category$_advisor_level value = 3 }
		}
		add_years_of_income = -1
		hire_advisor = {
			type = $type$
			skill = 3
		}
	}
	else_if = {
		limit = {
			check_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_$category$_advisor_level value = 2 }
		}
		add_years_of_income = -0.75
		hire_advisor = {
			type = $type$
			skill = 2
		}
	}
	else = {
		add_years_of_income = -0.5
		hire_advisor = {
			type = $type$
			skill = 1
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_clear_flags_for_current_supported_adm_advisor = {
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_treasurer
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_philosopher
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_artist
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_theologian
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_master_of_mint
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_inquisitor
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_natural_scientist
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 0 }
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_picking_supported_adm_advisor
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_checking_supported_adm_advisor
}
re_religion_mechanic_nestorian_patriarchy_flag_current_supported_adm_advisor = {
	if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_5_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_5_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 5 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_4_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_4_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 4 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_3_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_3_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 3 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_2_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_2_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 2 }
	}
	else = {
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_level value = 1 }
	}

	if = {
		limit = {
			advisor = treasurer
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_treasurer
	}
	else_if = {
		limit = {
			advisor = philosopher
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_philosopher
	}
	else_if = {
		limit = {
			advisor = artist
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_artist
	}
	else_if = {
		limit = {
			advisor = theologian
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_theologian
	}
	else_if = {
		limit = {
			advisor = master_of_mint
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_master_of_mint
	}
	else_if = {
		limit = {
			advisor = inquisitor
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_inquisitor
	}
	else_if = {
		limit = {
			advisor = natural_scientist
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_natural_scientist
	}
	else = {
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_treasurer
	}
}
re_religion_mechanic_nestorian_patriarchy_hire_new_supported_adm_advisor = {
	trigger_switch = {
		on_trigger = has_country_flag
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_treasurer = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = treasurer
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_philosopher = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = philosopher
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_artist = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = artist
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_theologian = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = theologian
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_master_of_mint = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = master_of_mint
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_inquisitor = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = inquisitor
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_adm_advisor_type_natural_scientist = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = adm
				type = natural_scientist
			}
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_clear_flags_for_current_supported_dip_advisor = {
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_statesman
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_diplomat
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_naval_reformer
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_trader
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_colonial_governor
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_navigator
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_spymaster
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 0 }
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_picking_supported_dip_advisor
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_checking_supported_dip_advisor
}
re_religion_mechanic_nestorian_patriarchy_flag_current_supported_dip_advisor = {
	if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_5_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_5_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 5 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_4_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_4_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 4 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_3_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_3_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 3 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_2_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_2_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 2 }
	}
	else = {
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_level value = 1 }
	}

	if = {
		limit = {
			advisor = statesman
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_statesman
	}
	else_if = {
		limit = {
			advisor = diplomat
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_diplomat
	}
	else_if = {
		limit = {
			advisor = naval_reformer
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_naval_reformer
	}
	else_if = {
		limit = {
			advisor = trader
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_trader
	}
	else_if = {
		limit = {
			advisor = colonial_governor
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_colonial_governor
	}
	else_if = {
		limit = {
			advisor = navigator
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_navigator
	}
	else_if = {
		limit = {
			advisor = spymaster
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_spymaster
	}
	else = {
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_statesman
	}
}
re_religion_mechanic_nestorian_patriarchy_hire_new_supported_dip_advisor = {
	trigger_switch = {
		on_trigger = has_country_flag
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_statesman = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = statesman
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_diplomat = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = diplomat
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_naval_reformer = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = naval_reformer
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_trader = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = trader
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_colonial_governor = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = colonial_governor
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_navigator = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = navigator
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_dip_advisor_type_spymaster = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = dip
				type = spymaster
			}
		}
	}
}

re_religion_mechanic_nestorian_patriarchy_clear_flags_for_current_supported_mil_advisor = {
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_organiser
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_reformer
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_commandant
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_grand_captain
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_recruitmaster
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_fortification_expert
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_quartermaster
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 0 }
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_picking_supported_mil_advisor
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_checking_supported_mil_advisor
}
re_religion_mechanic_nestorian_patriarchy_flag_current_supported_mil_advisor = {
	if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_5_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_5_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 5 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_4_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_4_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 4 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_3_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_3_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 3 }
	}
	else_if = {
		limit = {
			OR = {
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_2_modifier
				has_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_2_modifier
			}
		}
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 2 }
	}
	else = {
		set_variable = { which = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_level value = 1 }
	}

	if = {
		limit = {
			advisor = army_organiser
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_organiser
	}
	else_if = {
		limit = {
			advisor = army_reformer
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_reformer
	}
	else_if = {
		limit = {
			advisor = commandant
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_commandant
	}
	else_if = {
		limit = {
			advisor = grand_captain
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_grand_captain
	}
	else_if = {
		limit = {
			advisor = recruitmaster
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_recruitmaster
	}
	else_if = {
		limit = {
			advisor = fortification_expert
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_fortification_expert
	}
	else_if = {
		limit = {
			advisor = quartermaster
		}
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_quartermaster
	}
	else = {
		set_country_flag = re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_organiser
	}
}
re_religion_mechanic_nestorian_patriarchy_hire_new_supported_mil_advisor = {
	trigger_switch = {
		on_trigger = has_country_flag
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_organiser = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = army_organiser
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_army_reformer = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = army_reformer
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_commandant = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = commandant
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_grand_captain = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = grand_captain
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_recruitmaster = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = recruitmaster
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_fortification_expert = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = fortification_expert
			}
		}
		re_religion_mechanic_nestorian_patriarchy_supported_mil_advisor_type_quartermaster = {
			re_religion_mechanic_nestorian_patriarchy_define_supported_advisor = {
				category = mil
				type = quartermaster
			}
		}
	}
}

re_clear_all_religion_mechanic_nestorian_patriarchy_modifiers = {
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_main_center_of_reformation_selection_window_open
	clr_country_flag = re_religion_mechanic_nestorian_patriarchy_main_window_open
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_value value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_modifiers value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_missionaries value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_ttf value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_from_stability value = 0 }
	set_variable = { which = re_yearly_religion_mechanic_nestorian_patriarchy_value_modifier_from_opinion value = 0 }
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_selected_culture_1 value = 0 }
	set_variable = { which = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_selected_culture_2 value = 0 }
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_adm_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_dip_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_nestorian_mil_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_adm_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_dip_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_2_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_1_mil_1_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_5_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_5_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_5_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_6_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_6_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_6_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_7_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_7_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_7_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_8_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_8_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_8_nestorian_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_9_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_9_owned_modifier
	remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_9_nestorian_modifier
	every_owned_province = {
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_9_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_8_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_7_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_6_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_5_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_4_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_3_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_2_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_nestorian_fort_1_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_9_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_8_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_7_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_6_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_5_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_4_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_3_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_2_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_1_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_9_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_8_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_7_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_6_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_5_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_4_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_3_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_2_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_2_province_fort_1_multiple_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_province_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_3_province_accepted_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_province_nestorian_double_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_province_nestorian_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_province_double_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_4_province_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_5_province_nestorian_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_5_province_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_9_province_nestorian_modifier
		remove_province_modifier = re_religion_mechanic_nestorian_patriarchy_main_holy_site_9_province_modifier
	}
}

# for changing religion or stopping to exist
re_clear_all_religion_mechanic_nestorian_patriarchy_modifiers_when_changing_religion = {
	re_clear_all_religion_mechanic_nestorian_patriarchy_modifiers = yes
	if = {
		limit = {
			re_religion_mechanic_nestorian_patriarchy_is_patriarchy_controller = yes
		}
		if = {
			limit = {
				any_country = {
					NOT = { tag = PREV }
					re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
				}
			}
			151 = {
				province_event = { id = re_religion_mechanic_nestorian_patriarchy_events.3 } # New Patriarchy Controller
			}
		}
		else = {
			clr_country_flag = re_religion_mechanic_nestorian_patriarchy_is_patriarchy_controller
			clear_global_event_target = re_religion_mechanic_nestorian_patriarchy_patriarch_controller
			remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_interaction_3_modifier
			remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_main_interaction_6_modifier
			remove_country_modifier = re_religion_mechanic_nestorian_patriarchy_patriarch_controller_modifier
			clr_global_flag = re_religion_mechanic_nestorian_patriarchy_no_new_center_of_reformation
		}
	}
	if = {
		limit = {
			NOT = {
				any_country = {
					NOT = { tag = PREV }
					re_uses_religion_mechanic = { mechanic = nestorian_patriarchy }
				}
			}
		}
		re_religion_mechanic_nestorian_patriarchy_clear_center_of_reformation = yes
	}
}